# 环境搭建指南

## 1. 概述

本文档详细说明青羽书城前端开发环境的搭建步骤，包括必需软件的安装、配置和验证。

### 1.1 环境要求

| 软件 | 最低版本 | 推荐版本 | 说明 |
|------|---------|---------|------|
| Node.js | 16.x | 18.x LTS | JavaScript运行环境 |
| npm | 8.x | 9.x | 包管理器（Node.js自带） |
| pnpm | 7.x | 8.x | 推荐的包管理器 |
| Git | 2.30+ | 最新版 | 版本控制工具 |
| VS Code | 1.70+ | 最新版 | 推荐的代码编辑器 |

### 1.2 操作系统支持

- ✅ Windows 10/11
- ✅ macOS 10.15+
- ✅ Linux (Ubuntu 20.04+, CentOS 8+)

## 2. Node.js 安装

### 2.1 Windows 安装

#### 方式1：使用官方安装包（推荐新手）

1. **下载安装包**
   - 访问 [Node.js官网](https://nodejs.org/)
   - 下载 LTS 版本（推荐 18.x）
   - 选择 `.msi` 安装包

2. **运行安装程序**
   ```
   - 双击下载的 .msi 文件
   - 点击 "Next" 接受协议
   - 选择安装路径（默认即可）
   - 勾选 "Automatically install necessary tools"
   - 完成安装
   ```

3. **验证安装**
   ```bash
   # 打开 PowerShell 或 CMD
   node -v
   # 应该显示：v18.x.x
   
   npm -v
   # 应该显示：9.x.x
   ```

#### 方式2：使用 nvm-windows（推荐进阶用户）

1. **下载 nvm-windows**
   - 访问 [nvm-windows releases](https://github.com/coreybutler/nvm-windows/releases)
   - 下载 `nvm-setup.exe`

2. **安装 nvm**
   ```bash
   # 运行安装程序，按提示完成安装
   
   # 验证安装
   nvm version
   ```

3. **使用 nvm 安装 Node.js**
   ```bash
   # 查看可用版本
   nvm list available
   
   # 安装 Node.js 18
   nvm install 18
   
   # 使用该版本
   nvm use 18
   
   # 验证
   node -v
   ```

### 2.2 macOS 安装

#### 方式1：使用 Homebrew（推荐）

1. **安装 Homebrew（如果未安装）**
   ```bash
   /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
   ```

2. **安装 Node.js**
   ```bash
   # 安装最新 LTS 版本
   brew install node@18
   
   # 链接到系统路径
   brew link node@18
   
   # 验证安装
   node -v
   npm -v
   ```

#### 方式2：使用 nvm（推荐进阶用户）

1. **安装 nvm**
   ```bash
   curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
   
   # 重新加载配置
   source ~/.bashrc  # 或 ~/.zshrc
   ```

2. **安装 Node.js**
   ```bash
   # 安装 Node.js 18
   nvm install 18
   
   # 设置默认版本
   nvm alias default 18
   
   # 使用该版本
   nvm use 18
   ```

### 2.3 Linux 安装

#### Ubuntu/Debian

```bash
# 更新包管理器
sudo apt update

# 安装 Node.js 18
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# 验证安装
node -v
npm -v
```

#### CentOS/RHEL

```bash
# 安装 Node.js 18
curl -fsSL https://rpm.nodesource.com/setup_18.x | sudo bash -
sudo yum install -y nodejs

# 验证安装
node -v
npm -v
```

## 3. 包管理器配置

### 3.1 npm 配置

#### 配置国内镜像源（提升下载速度）

```bash
# 方式1：使用淘宝镜像
npm config set registry https://registry.npmmirror.com

# 方式2：使用官方镜像
npm config set registry https://registry.npmjs.org

# 验证配置
npm config get registry
```

#### 其他推荐配置

```bash
# 设置缓存目录（可选）
npm config set cache "D:\npm-cache"  # Windows
npm config set cache "~/.npm"        # macOS/Linux

# 设置全局安装目录（可选）
npm config set prefix "D:\npm-global"  # Windows
npm config set prefix "~/.npm-global"  # macOS/Linux
```

### 3.2 pnpm 安装和配置（推荐）

#### 安装 pnpm

```bash
# 使用 npm 安装
npm install -g pnpm

# 验证安装
pnpm -v
```

#### 配置 pnpm

```bash
# 配置镜像源
pnpm config set registry https://registry.npmmirror.com

# 配置存储目录（可选）
pnpm config set store-dir "D:\\.pnpm-store"  # Windows
pnpm config set store-dir "~/.pnpm-store"    # macOS/Linux

# 查看配置
pnpm config list
```

#### pnpm 优势

- ✅ **节省磁盘空间**：使用硬链接共享依赖
- ✅ **安装速度快**：比 npm 快 2-3 倍
- ✅ **严格的依赖管理**：避免幽灵依赖问题

## 4. Git 安装和配置

### 4.1 安装 Git

#### Windows
```bash
# 下载 Git for Windows
# https://git-scm.com/download/win

# 或使用 Chocolatey
choco install git
```

#### macOS
```bash
# 使用 Homebrew
brew install git

# 或使用 Xcode Command Line Tools
xcode-select --install
```

#### Linux
```bash
# Ubuntu/Debian
sudo apt-get install git

# CentOS/RHEL
sudo yum install git
```

### 4.2 配置 Git

```bash
# 设置用户名和邮箱
git config --global user.name "你的姓名"
git config --global user.email "your.email@example.com"

# 设置默认分支名
git config --global init.defaultBranch main

# 设置编辑器
git config --global core.editor "code --wait"  # VS Code

# 设置换行符（Windows）
git config --global core.autocrlf true

# 设置换行符（macOS/Linux）
git config --global core.autocrlf input

# 查看配置
git config --list
```

### 4.3 配置 SSH Key（推荐）

```bash
# 生成 SSH key
ssh-keygen -t ed25519 -C "your.email@example.com"

# 查看公钥
cat ~/.ssh/id_ed25519.pub  # macOS/Linux
type %userprofile%\.ssh\id_ed25519.pub  # Windows

# 将公钥添加到 GitHub/GitLab
# 复制公钥内容，在 GitHub Settings > SSH Keys 中添加
```

## 5. VS Code 安装和配置

### 5.1 安装 VS Code

- 访问 [VS Code官网](https://code.visualstudio.com/)
- 下载对应系统的安装包
- 运行安装程序

### 5.2 推荐插件

#### 必装插件

```bash
# Vue 开发
- Volar (Vue 3 官方插件)
- Vue VSCode Snippets

# JavaScript/TypeScript
- ESLint
- Prettier - Code formatter

# Git
- GitLens

# 其他工具
- Chinese (Simplified) Language Pack (中文语言包)
- Path Intellisense (路径智能提示)
- Auto Rename Tag (自动重命名标签)
- Bracket Pair Colorizer (括号配对着色)
```

#### 安装方式

```bash
# 方式1：在 VS Code 扩展市场搜索安装

# 方式2：使用命令行安装
code --install-extension Vue.volar
code --install-extension dbaeumer.vscode-eslint
code --install-extension esbenp.prettier-vscode
code --install-extension eamodio.gitlens
```

### 5.3 VS Code 配置

创建项目级别的配置文件：

**`.vscode/settings.json`**
```json
{
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "eslint.validate": [
    "javascript",
    "javascriptreact",
    "vue"
  ],
  "volar.takeOverMode.enabled": true,
  "[vue]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  }
}
```

**`.vscode/extensions.json`**
```json
{
  "recommendations": [
    "Vue.volar",
    "dbaeumer.vscode-eslint",
    "esbenp.prettier-vscode",
    "eamodio.gitlens"
  ]
}
```

## 6. 浏览器开发工具

### 6.1 推荐浏览器

- **Chrome** (推荐) - 最新版本
- **Edge** - 最新版本
- **Firefox** - 最新版本

### 6.2 浏览器插件

#### Vue.js DevTools
```bash
# Chrome Web Store 搜索安装
# 或访问：
https://chrome.google.com/webstore/detail/vuejs-devtools/nhdogjmejiglipccpnnnanhbledajbpd
```

#### 其他推荐插件
- React Developer Tools（如果需要）
- Redux DevTools
- Wappalyzer（识别网站技术栈）

## 7. 环境验证

### 7.1 验证清单

创建测试脚本验证环境：

**`check-env.js`**
```javascript
#!/usr/bin/env node

const { execSync } = require('child_process')

const checks = [
  { name: 'Node.js', cmd: 'node -v', minVersion: 'v16' },
  { name: 'npm', cmd: 'npm -v', minVersion: '8' },
  { name: 'pnpm', cmd: 'pnpm -v', minVersion: '7' },
  { name: 'Git', cmd: 'git --version', minVersion: '2.30' }
]

console.log('🔍 检查开发环境...\n')

checks.forEach(({ name, cmd, minVersion }) => {
  try {
    const version = execSync(cmd, { encoding: 'utf8' }).trim()
    console.log(`✅ ${name}: ${version}`)
    
    if (minVersion && !version.includes(minVersion.split('.')[0])) {
      console.log(`   ⚠️  建议版本: ${minVersion}+`)
    }
  } catch (error) {
    console.log(`❌ ${name}: 未安装`)
  }
})

console.log('\n✨ 环境检查完成！')
```

运行检查：
```bash
node check-env.js
```

### 7.2 预期输出

```
🔍 检查开发环境...

✅ Node.js: v18.17.0
✅ npm: 9.6.7
✅ pnpm: 8.6.0
✅ Git: git version 2.41.0

✨ 环境检查完成！
```

## 8. 常见问题

### 8.1 Node.js 相关

#### 问题1：node 命令不存在
```bash
# Windows - 添加到环境变量
# 控制面板 > 系统 > 高级系统设置 > 环境变量
# 添加 Node.js 安装路径到 Path

# macOS/Linux - 添加到 PATH
export PATH=$PATH:/usr/local/bin/node
source ~/.bashrc  # 或 ~/.zshrc
```

#### 问题2：npm 下载速度慢
```bash
# 使用国内镜像
npm config set registry https://registry.npmmirror.com

# 或使用 cnpm
npm install -g cnpm --registry=https://registry.npmmirror.com
```

#### 问题3：权限错误（macOS/Linux）
```bash
# 方式1：使用 nvm（推荐）
# 按照上面的 nvm 安装步骤重新安装 Node.js

# 方式2：修改 npm 全局目录权限
mkdir ~/.npm-global
npm config set prefix '~/.npm-global'
echo 'export PATH=~/.npm-global/bin:$PATH' >> ~/.bashrc
source ~/.bashrc
```

### 8.2 Git 相关

#### 问题1：Git 中文乱码
```bash
git config --global core.quotepath false
git config --global gui.encoding utf-8
git config --global i18n.commitencoding utf-8
```

#### 问题2：SSH 连接失败
```bash
# 测试 SSH 连接
ssh -T git@github.com

# 如果失败，检查 SSH key
ls -al ~/.ssh

# 重新生成 SSH key
ssh-keygen -t ed25519 -C "your.email@example.com"
```

### 8.3 VS Code 相关

#### 问题1：Volar 和 Vetur 冲突
```bash
# 禁用 Vetur
# 在 VS Code 扩展中搜索 Vetur，点击禁用

# 启用 Volar 的 Take Over Mode
# 设置 > 搜索 "volar.takeOverMode.enabled" > 勾选
```

#### 问题2：ESLint 不工作
```bash
# 确保安装了 ESLint 插件
code --install-extension dbaeumer.vscode-eslint

# 重启 VS Code
# 打开命令面板 (Ctrl+Shift+P)
# 输入 "Reload Window"
```

## 9. 下一步

环境搭建完成后，请继续阅读：

- [项目启动](./项目启动.md) - 克隆项目并启动开发服务器
- [开发工作流](./开发工作流.md) - 了解日常开发流程

## 10. 参考资料

- [Node.js 官方文档](https://nodejs.org/docs/)
- [npm 官方文档](https://docs.npmjs.com/)
- [pnpm 官方文档](https://pnpm.io/)
- [Git 官方文档](https://git-scm.com/doc)
- [VS Code 官方文档](https://code.visualstudio.com/docs)

---

**文档版本**：v1.0.0  
**创建时间**：2025年10月13日  
**最后更新**：2025年10月13日  
**维护者**：前端团队

