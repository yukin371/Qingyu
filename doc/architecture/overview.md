# 架构总览

## 整体架构

青羽书城前端采用现代化的单页应用（SPA）架构，基于Vue 3生态系统构建。

### 分层架构

```
┌─────────────────────────────────────┐
│      Pages (页面层)                  │
│      组织页面结构和逻辑              │
├─────────────────────────────────────┤
│      Components (组件层)             │
│      可复用的UI组件                  │
├─────────────────────────────────────┤
│      Stores (状态层)                │
│      Pinia全局状态管理               │
├─────────────────────────────────────┤
│      API (接口层)                    │
│      后端API调用封装                 │
├─────────────────────────────────────┤
│      Utils (工具层)                  │
│      通用工具和辅助函数              │
└─────────────────────────────────────┘
```

## 技术选型

### 核心框架

| 技术         | 版本   | 选择理由                                        |
| ------------ | ------ | ----------------------------------------------- |
| Vue 3        | ^3.4.0 | Composition API、更好的TypeScript支持、性能优化 |
| Element Plus | ^2.4.0 | 丰富的组件库、Vue 3原生支持、企业级UI           |
| Pinia        | ^2.1.0 | Vue官方推荐、类型安全、开发工具支持             |
| Vue Router   | ^4.2.0 | 动态路由、路由守卫、懒加载支持                  |

### 开发工具

| 工具     | 版本   | 用途                       |
| -------- | ------ | -------------------------- |
| Vite     | ^5.0.0 | 快速的开发服务器和构建工具 |
| Axios    | ^1.6.0 | HTTP客户端，Promise支持    |
| ESLint   | ^8.0.0 | 代码质量检查               |
| Prettier | ^3.0.0 | 代码格式化                 |

## 设计原则

### 1. 单一职责原则

每个组件、模块只负责一个明确的功能。

### 2. 组件复用

通过props和slots实现组件的高度复用。

### 3. 状态集中管理

使用Pinia进行集中状态管理。

### 4. 接口统一封装

统一的API调用和错误处理机制。

## 模块划分

### 核心模块

- **App Shell**：应用外壳、导航、布局
- **Router**：路由管理和导航控制
- **Store**：全局状态管理
- **API Client**：HTTP请求和响应处理

### 业务模块

- **书城首页**：Banner轮播、榜单展示、推荐内容
- **榜单系统**：实时榜、周榜、月榜、新人榜
- **书籍展示**：书籍列表、详情、搜索
- **用户系统**：登录、注册、个人中心

### 共享模块

- **UI Components**：可复用的UI组件
- **Utils**：工具函数和辅助方法
- **Constants**：常量定义

## 数据流

```
用户操作
  ↓
组件事件
  ↓
Store Action
  ↓
API调用
  ↓
更新State
  ↓
组件重新渲染
```

## 目录结构

```
src/
├── api/            # API接口层
├── assets/         # 静态资源
├── components/     # 公共组件
├── composables/    # 组合式函数
├── router/         # 路由配置
├── stores/         # 状态管理
├── utils/          # 工具函数
├── views/          # 页面组件
├── App.vue         # 根组件
└── main.js         # 入口文件
```

## 性能策略

### 1. 代码分割

- 路由级别懒加载
- 组件异步加载
- 第三方库按需引入

### 2. 资源优化

- 图片懒加载
- CDN加速
- Gzip压缩

### 3. 渲染优化

- 虚拟滚动
- v-memo优化
- shallowRef/shallowReactive

## 安全策略

### 1. XSS防护

- 使用Vue的模板语法（自动转义）
- 避免使用v-html
- 输入验证和过滤

### 2. CSRF防护

- 请求添加CSRF Token
- 使用SameSite Cookie

### 3. 认证授权

- JWT Token认证
- 路由守卫权限检查
- API请求携带Token

## 可扩展性设计

### 1. 插件化

支持功能模块的插件化开发。

### 2. 主题定制

支持Element Plus主题定制。

### 3. 国际化

预留i18n国际化支持。

## 参考文档

- [前端架构设计](./前端架构设计.md)
- [组件架构](./组件架构设计.md)
- [状态管理架构](./状态管理架构.md)
- [性能优化](./性能优化架构.md)

---

**最后更新**：2025年10月17日
